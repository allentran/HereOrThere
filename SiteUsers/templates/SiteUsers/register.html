{% extends "base.html" %}

{% block pagetitle %}
Register New User
{% endblock %}

{% block jumboheading %}
{% endblock %}
{% block script %}
 // Logout current user if registering new user
  FB.logout(function(response) {
});

  function testAPI() {
      document.getElementById("fblogin").innerHTML = ''
      document.getElementById("submitbutton").disabled = false;
  }

  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  function statusChangeCallback(response) {
    console.log('statusChangeCallback');
    console.log(response);
    // The response object is returned with a status field that lets the
    // app know the current login status of the person.
    // Full docs on the response object can be found in the documentation
    // for FB.getLoginStatus().
    if (response.status === 'connected') {
      // Logged into your app and Facebook.
      testAPI();
    } else if (response.status === 'not_authorized') {
      // The person is logged into Facebook, but not your app.
      document.getElementById('status').innerHTML = 'Please log ' +
        'into this app.';
    } else {
      // The person is not logged into Facebook, so we're not sure if
      // they are logged into this app or not.
      document.getElementById('status').innerHTML = 'Please log ' +
        'into Facebook.';
    }
  }
  
{% endblock %}

{% block content %}

<form class="pure-form pure-form-aligned" method="post">
{% csrf_token %}
    <fieldset >
        <input type="text" name='username' class="pure-input-1-2" placeholder="Username">
        <input type="password" name="password" class="pure-input-1-2" placeholder="Password">
        <input type="email" name="email" class="pure-input-1-2" placeholder="Email">
    </fieldset>
    <fieldset class="pure-group" id = "fblogin">
        <fb:login-button size="large" scope={{FBPermissions}}
                 onlogin="checkLoginState()">
  Enable Facebook
</fb:login-button>
    </fieldset>
    <button type="submit" disabled = true id ="submitbutton" class="pure-button pure-input-1-2 pure-button-primary">Register now</button>
</form>



{% endblock %}
